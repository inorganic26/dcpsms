rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // =========================================================================
    // 1. [공개] 반 목록 (Classes)
    // -------------------------------------------------------------------------
    // 학부모님이 로그인하기 전, 드롭다운 메뉴에 표시할 반 목록을 가져오기 위해
    // 'read' 권한을 'true'(누구나 가능)로 설정합니다.
    // =========================================================================
    match /classes/{classId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // =========================================================================
    // 2. [비공개] 나머지 모든 데이터 (학생, 성적, 숙제 등)
    // -------------------------------------------------------------------------
    // 반 목록을 제외한 다른 모든 데이터는 로그인한 사용자만 접근할 수 있습니다.
    // (보안을 위해 match 순서상 위에 있는 구체적인 규칙이 먼저 적용됩니다.)
    // =========================================================================
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
    
  }
}