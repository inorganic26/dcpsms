<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>학습 관리 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .view { display: none; }
        .active-view { display: block; }
        .admin-section-view { display: none; }
        .portal-card { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        .portal-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3b82f6; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .modal-backdrop { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 50; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
        .option-btn { transition: all 0.2s ease-in-out; }
        .option-btn.correct { background-color: #22c55e; color: white; border-color: #16a34a; }
        .option-btn.incorrect { background-color: #ef4444; color: white; border-color: #dc2626; }
        .disabled { pointer-events: none; opacity: 0.8; }
        .subject-option { cursor: pointer; padding: 8px 12px; border-radius: 6px; border: 1px solid #e2e8f0; transition: all 0.2s ease; }
        .subject-option.selected { background-color: #3b82f6; color: white; border-color: #2563eb; }
        .student-screen { display: none; width: 100%; min-height: 100vh; flex-direction: column; }
        .lesson-card.dragging { opacity: 0.5; background: #e0f2fe; }
        .drag-handle { cursor: grab; }
        .drag-handle:active { cursor: grabbing; }
    </style>
</head>
<body class="bg-slate-100">

    <div id="toast-notification" style="transition: opacity 0.3s, transform 0.3s;" class="fixed top-8 right-8 z-[100] p-4 rounded-lg shadow-lg text-white transform translate-x-[120%] opacity-0">
        <p id="toast-message"></p>
    </div>

    <div id="portal-view" class="view">
        <div class="w-full min-h-screen flex items-center justify-center p-4">
            <div class="w-full max-w-4xl mx-auto">
                <header class="text-center mb-10">
                    <h1 class="text-4xl font-bold text-slate-800">학습 관리 시스템</h1>
                    <p class="text-slate-500 mt-2">사용하실 앱을 선택하세요.</p>
                </header>
                <main class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div id="goto-admin-btn" class="portal-card cursor-pointer bg-white p-8 rounded-2xl shadow-lg text-center flex flex-col items-center">
                        <div class="bg-red-100 p-4 rounded-full mb-4"><svg class="w-8 h-8 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-1.007 1.11-1.226l.554-.221a2.25 2.25 0 012.387 2.387l-.221.554c-.219.55-.684 1.02-1.226 1.11l-3.031.606a2.25 2.25 0 00-1.288 1.288l-.606 3.031c-.09.542-.56 1.007-1.11 1.226l-.554.221a2.25 2.25 0 01-2.387-2.387l.221-.554c.219-.55.684-1.02 1.226-1.11l3.031-.606a2.25 2.25 0 001.288-1.288l.606-3.031z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 21a9.75 9.75 0 100-19.5 9.75 9.75 0 000 19.5z" /></svg></div>
                        <h2 class="text-xl font-bold text-slate-800">관리자 앱</h2>
                        <p class="text-slate-500 mt-2 text-sm">반, 과목, 학생, 학습을<br>전체적으로 관리합니다.</p>
                    </div>
                    <div id="goto-teacher-btn" class="portal-card cursor-pointer bg-white p-8 rounded-2xl shadow-lg text-center flex flex-col items-center">
                        <div class="bg-green-100 p-4 rounded-full mb-4"><svg class="w-8 h-8 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg></div>
                        <h2 class="text-xl font-bold text-slate-800">선생님 앱</h2>
                        <p class="text-slate-500 mt-2 text-sm">학생들의 학습 현황을<br>실시간으로 확인합니다.</p>
                    </div>
                    <div id="goto-student-btn" class="portal-card cursor-pointer bg-white p-8 rounded-2xl shadow-lg text-center flex flex-col items-center">
                        <div class="bg-blue-100 p-4 rounded-full mb-4"><svg class="w-8 h-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg></div>
                        <h2 class="text-xl font-bold text-slate-800">학생 앱</h2>
                        <p class="text-slate-500 mt-2 text-sm">로그인하여 학습을<br>시작합니다.</p>
                    </div>
                </main>
                <footer class="text-center mt-12 pt-4 border-t">
                    <p class="text-xs text-slate-400">Classroom ID: <span id="portal-session-id" class="font-mono"></span></p>
                    <button id="reset-session-btn" class="text-xs text-blue-500 hover:underline mt-1">사용자 초기화</button>
                </footer>
            </div>
        </div>
    </div>

    <div id="admin-view" class="view">
        <div class="container mx-auto max-w-5xl p-4 sm:p-6 md:p-8">
            <div id="admin-dashboard-view">
                <button class="back-to-portal-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 포털로 돌아가기</button>
                <header class="text-center mb-10">
                    <h1 class="text-3xl font-bold text-slate-800">관리자 대시보드</h1>
                    <p class="text-slate-500 mt-2">관리할 항목을 선택하세요.</p>
                </header>
                <main class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div id="goto-subject-mgmt-btn" class="portal-card cursor-pointer bg-white p-6 rounded-xl shadow-md text-center">
                        <h2 class="text-lg font-bold text-slate-800">과목 관리</h2>
                    </div>
                    <div id="goto-textbook-mgmt-btn" class="portal-card cursor-pointer bg-white p-6 rounded-xl shadow-md text-center">
                        <h2 class="text-lg font-bold text-slate-800">교재 관리</h2>
                    </div>
                    <div id="goto-class-mgmt-btn" class="portal-card cursor-pointer bg-white p-6 rounded-xl shadow-md text-center">
                        <h2 class="text-lg font-bold text-slate-800">반 관리</h2>
                    </div>
                    <div id="goto-student-mgmt-btn" class="portal-card cursor-pointer bg-white p-6 rounded-xl shadow-md text-center">
                        <h2 class="text-lg font-bold text-slate-800">학생 명단 관리</h2>
                    </div>
                    <div id="goto-lesson-mgmt-btn" class="portal-card cursor-pointer bg-white p-6 rounded-xl shadow-md text-center">
                        <h2 class="text-lg font-bold text-slate-800">학습 세트 관리</h2>
                    </div>
                </main>
            </div>
            <div id="admin-subject-mgmt-view" class="admin-section-view">
                <button class="back-to-admin-dashboard-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 관리자 메뉴로</button>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-bold text-slate-800 border-b pb-4 mb-6">과목 관리 (공통)</h2>
                    <div class="flex items-start gap-4"><div class="flex-grow"><label for="admin-new-subject-name" class="block text-sm font-medium text-slate-700 mb-2">새 과목 이름</label><input type="text" id="admin-new-subject-name" class="w-full px-4 py-2 border border-slate-300 rounded-lg" placeholder="예: 공통 수학"></div><div class="flex-shrink-0 pt-7"><button id="admin-add-subject-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition">+ 과목 추가</button></div></div>
                    <div class="mt-6"><h3 class="text-lg font-semibold text-slate-700 mb-2">생성된 과목 목록</h3><div id="admin-subjects-list" class="space-y-2"></div></div>
                </div>
            </div>
            <div id="admin-textbook-mgmt-view" class="admin-section-view">
                <button class="back-to-admin-dashboard-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 관리자 메뉴로</button>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-bold text-slate-800 border-b pb-4 mb-6">교재 관리</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <label for="admin-subject-select-for-textbook" class="block text-sm font-medium text-slate-700 mb-2">교재를 추가할 과목 선택</label>
                            <select id="admin-subject-select-for-textbook" class="w-full p-2 border border-slate-300 rounded-lg"></select>
                            <div id="admin-textbook-management-content" class="mt-4" style="display: none;">
                                <div class="flex items-start gap-4">
                                    <div class="flex-grow"><label for="admin-new-textbook-name" class="block text-sm font-medium text-slate-700 mb-2">새 교재 이름</label><input type="text" id="admin-new-textbook-name" class="w-full px-4 py-2 border border-slate-300 rounded-lg" placeholder="예: 수학의 정석"></div>
                                    <div class="flex-shrink-0 pt-7"><button id="admin-add-textbook-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition">+ 교재 추가</button></div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-slate-700 mb-2">등록된 교재 목록</h3>
                            <div id="admin-textbooks-list" class="space-y-2"><p class="text-sm text-slate-400">먼저 과목을 선택해주세요.</p></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="admin-class-mgmt-view" class="admin-section-view">
                <button class="back-to-admin-dashboard-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 관리자 메뉴로</button>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-bold text-slate-800 border-b pb-4 mb-6">반 관리</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <div class="flex items-start gap-4"><div class="flex-grow"><label for="admin-new-class-name" class="block text-sm font-medium text-slate-700 mb-2">새 반 이름</label><input type="text" id="admin-new-class-name" class="w-full px-4 py-2 border border-slate-300 rounded-lg" placeholder="예: 1학년 1반"></div><div class="flex-shrink-0 pt-7"><button id="admin-add-class-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition">+ 반 추가</button></div></div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-slate-700 mb-2">이 반에 연결할 과목 선택</label>
                                <div id="admin-class-subjects-options" class="space-y-2 p-2 border rounded-lg max-h-48 overflow-y-auto"><p class="text-slate-400">먼저 공통 과목을 생성해주세요.</p></div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-slate-700 mb-2">생성된 반 목록</h3><div id="admin-classes-list" class="space-y-2"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="admin-student-mgmt-view" class="admin-section-view">
                <button class="back-to-admin-dashboard-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 관리자 메뉴로</button>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-bold text-slate-800 border-b pb-4 mb-6">학생 명단 관리</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <label for="admin-class-select-for-student" class="block text-sm font-medium text-slate-700 mb-2">학생을 추가할 반 선택</label><select id="admin-class-select-for-student" class="w-full p-2 border border-slate-300 rounded-lg"></select>
                            <div class="grid grid-cols-2 gap-4 mt-4">
                                <div><label for="admin-new-student-name" class="block text-sm font-medium text-slate-700 mb-2">새 학생 이름</label><input type="text" id="admin-new-student-name" class="w-full px-4 py-2 border border-slate-300 rounded-lg" placeholder="예: 홍길동"></div>
                                <div><label for="admin-new-student-phone" class="block text-sm font-medium text-slate-700 mb-2">전화번호</label><input type="tel" id="admin-new-student-phone" class="w-full px-4 py-2 border border-slate-300 rounded-lg" placeholder="비밀번호는 뒷 4자리"></div>
                            </div>
                            <div class="flex justify-end mt-4"><button id="admin-add-student-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition">+ 학생 추가</button></div>
                        </div>
                        <div><h3 class="text-lg font-semibold text-slate-700 mb-2">등록된 학생 목록</h3><div id="admin-students-list" class="space-y-2"><p class="text-sm text-slate-400">먼저 반을 선택해주세요.</p></div></div>
                    </div>
                </div>
            </div>
            <div id="admin-lesson-mgmt-view" class="admin-section-view">
                <button class="back-to-admin-dashboard-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 관리자 메뉴로</button>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                    <div class="border-b pb-4 mb-6">
                        <h1 class="text-2xl font-bold text-slate-800">학습 세트 관리</h1>
                        <div class="w-full md:w-1/2">
                            <label for="admin-subject-select-for-lesson" class="block text-sm font-medium text-slate-700 mb-2">과목 선택</label>
                            <select id="admin-subject-select-for-lesson" class="w-full p-2 border border-slate-300 rounded-lg"></select>
                        </div>
                    </div>
                    <div id="admin-lessons-management-content" class="hidden">
                        <div class="flex justify-end gap-2">
                            <button id="admin-save-lesson-order-btn" class="bg-green-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-green-700 transition duration-300 shadow-md">순서 저장</button>
                            <button id="admin-show-new-lesson-modal-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition duration-300 shadow-md">+ 새 학습 세트 만들기</button>
                        </div>
                        <div id="admin-lessons-list-container" class="mt-6"><div id="admin-lessons-list" class="space-y-4"></div></div>
                    </div>
                     <p id="admin-lesson-prompt" class="text-center text-slate-500 py-8">먼저 과목을 선택해주세요.</p>
                </div>
            </div>
        </div>
        <div id="admin-new-lesson-modal" class="modal-backdrop" style="display: none;">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
                <header class="p-6 border-b flex justify-between items-center"><h2 id="admin-lesson-modal-title" class="text-2xl font-bold text-slate-800">새 학습 세트 만들기</h2><button id="admin-close-modal-btn" class="text-slate-500 hover:text-slate-800">&times;</button></header>
                <main class="p-6 flex-grow overflow-y-auto custom-scrollbar grid grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold text-lg mb-4 text-slate-700">학습 정보</h3>
                        <div class="space-y-4">
                            <div><label for="admin-lesson-title" class="block text-sm font-medium text-slate-600 mb-1">학습 제목</label><input type="text" id="admin-lesson-title" class="w-full p-2 border rounded-md"></div>
                            <div><label for="admin-video1-url" class="block text-sm font-medium text-slate-600 mb-1">영상 1 URL (기본 영상)</label><input type="url" id="admin-video1-url" class="w-full p-2 border rounded-md"></div>
                            <div><label for="admin-video2-url" class="block text-sm font-medium text-slate-600 mb-1">영상 2 URL (문제 풀이 영상)</label><input type="url" id="admin-video2-url" class="w-full p-2 border rounded-md"></div>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg mb-4 text-slate-700">퀴즈 정보 (JSON)</h3>
                        <div><label for="admin-quiz-json-input" class="block text-sm font-medium text-slate-600 mb-1">문제은행 JSON 붙여넣기</label><textarea id="admin-quiz-json-input" rows="8" class="w-full p-2 border rounded-md font-mono text-sm"></textarea></div>
                        <button id="admin-preview-quiz-btn" class="mt-2 w-full bg-slate-200 hover:bg-slate-300 text-slate-800 font-semibold py-2 px-4 rounded-md transition">미리보기</button>
                        <div id="admin-questions-preview-container" class="mt-4 p-4 border rounded-md bg-slate-50 hidden max-h-48 overflow-y-auto custom-scrollbar">
                            <h4 id="admin-questions-preview-title" class="font-bold mb-2 text-slate-700">생성된 퀴즈</h4>
                            <div id="admin-questions-preview-list" class="text-sm space-y-1 text-slate-600"></div>
                        </div>
                    </div>
                </main>
                <footer class="p-6 border-t flex justify-end gap-3">
                    <button id="admin-cancel-btn" class="bg-slate-100 hover:bg-slate-200 text-slate-800 font-semibold py-2 px-5 rounded-lg">취소</button>
                    <button id="admin-save-lesson-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg flex items-center justify-center min-w-[100px]"><span id="admin-save-btn-text">저장하기</span><div id="admin-save-loader" class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin hidden"></div></button>
                </footer>
            </div>
        </div>
        <div id="admin-edit-class-modal" class="modal-backdrop" style="display: none;">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <header class="p-6 border-b flex justify-between items-center"><h2 class="text-2xl font-bold text-slate-800">반 정보 수정</h2><button id="admin-close-edit-class-modal-btn" class="text-slate-500 hover:text-slate-800">&times;</button></header>
                <main class="p-6 flex-grow overflow-y-auto custom-scrollbar">
                    <p class="mb-1 text-sm font-medium text-slate-600">반 이름</p>
                    <p id="admin-edit-class-name" class="text-lg font-bold text-slate-800 mb-6"></p>
                    <p class="mb-2 text-sm font-medium text-slate-600">이 반에서 사용할 과목 및 교재 선택</p>
                    <div id="admin-edit-class-subjects-and-textbooks" class="space-y-4"></div>
                </main>
                <footer class="p-6 border-t flex justify-end gap-3">
                    <button id="admin-cancel-edit-class-btn" class="bg-slate-100 hover:bg-slate-200 text-slate-800 font-semibold py-2 px-5 rounded-lg">취소</button>
                    <button id="admin-save-class-edit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg">변경사항 저장</button>
                </footer>
            </div>
        </div>
    </div>

    <div id="teacher-view" class="view">
        <div class="container mx-auto max-w-6xl p-4 sm:p-6 md:p-8">
            <button class="back-to-portal-btn mb-6 bg-slate-200 text-slate-800 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition">&larr; 포털로 돌아가기</button>
            <div id="teacher-loading-screen" class="w-full py-20 flex justify-center items-center" style="display: none;"><div class="loader"></div></div>
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                <header class="flex flex-col md:flex-row gap-4 border-b pb-6 mb-6">
                    <div class="flex-1"><label for="teacher-class-select" class="block text-sm font-medium text-slate-700 mb-2">반 선택</label><select id="teacher-class-select" class="w-full p-2 border border-slate-300 rounded-lg"></select></div>
                    <div class="flex-1"><label for="teacher-view-select" class="block text-sm font-medium text-slate-700 mb-2">확인할 내용</label><select id="teacher-view-select" class="w-full p-2 border border-slate-300 rounded-lg" disabled><option value="lessons">학습 현황</option><option value="homework">숙제 현황</option></select></div>
                </header>

                <main>
                    <div id="teacher-lessons-dashboard" style="display: none;">
                        <div class="flex flex-col md:flex-row gap-4 mb-6">
                            <div class="flex-1"><label for="teacher-subject-select" class="block text-sm font-medium text-slate-700 mb-2">과목 선택</label><select id="teacher-subject-select" class="w-full p-2 border border-slate-300 rounded-lg" disabled></select></div>
                            <div class="flex-1"><label for="teacher-lesson-select" class="block text-sm font-medium text-slate-700 mb-2">학습 선택</label><select id="teacher-lesson-select" class="w-full p-2 border border-slate-300 rounded-lg" disabled></select></div>
                        </div>
                        <div id="teacher-dashboard-content" class="overflow-x-auto" style="display: none;">
                             <h2 id="teacher-selected-lesson-title" class="text-xl font-bold text-slate-800 mb-4"></h2>
                             <table class="w-full text-sm text-left text-gray-500"><tbody id="teacher-results-table-body"></tbody></table>
                        </div>
                    </div>

                    <div id="teacher-homework-dashboard" style="display: none;">
                        <div class="flex justify-between items-center mb-6">
                            <div class="flex-1 max-w-md"><label for="teacher-homework-select" class="block text-sm font-medium text-slate-700 mb-2">숙제 선택</label><select id="teacher-homework-select" class="w-full p-2 border border-slate-300 rounded-lg"></select></div>
                            <div id="teacher-assign-homework-btn-container" style="display: none;"><button id="teacher-assign-homework-btn" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition">+ 새 숙제 출제</button></div>
                        </div>
                        <div id="teacher-homework-content" class="overflow-x-auto" style="display: none;">
                            <div class="flex justify-between items-center mb-4">
                                <h2 id="teacher-selected-homework-title" class="text-xl font-bold text-slate-800"></h2>
                                <div id="teacher-homework-management-buttons" class="flex gap-2" style="display: none;">
                                    <button id="teacher-edit-homework-btn" class="text-sm bg-yellow-500 text-white font-semibold px-3 py-1 rounded-lg">수정</button>
                                    <button id="teacher-delete-homework-btn" class="text-sm bg-red-500 text-white font-semibold px-3 py-1 rounded-lg">삭제</button>
                                </div>
                            </div>
                            <table class="w-full text-sm text-left text-gray-500"><tbody id="teacher-homework-table-body"></tbody></table>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <div id="teacher-assign-homework-modal" class="modal-backdrop" style="display: none;">
             <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md">
                <header class="p-6 border-b flex justify-between items-center"><h2 id="teacher-homework-modal-title" class="text-xl font-bold text-slate-800">새 숙제 출제</h2><button id="teacher-close-homework-modal-btn" class="text-slate-500 hover:text-slate-800">&times;</button></header>
                <main class="p-6 space-y-4">
                    <div><label for="teacher-homework-subject-select" class="block text-sm font-medium text-slate-600 mb-1">과목</label><select id="teacher-homework-subject-select" class="w-full p-2 border rounded-md"></select></div>
                    <div><label for="teacher-homework-textbook-select" class="block text-sm font-medium text-slate-600 mb-1">교재</label><select id="teacher-homework-textbook-select" class="w-full p-2 border rounded-md" disabled></select></div>
                    <div><label for="teacher-homework-due-date" class="block text-sm font-medium text-slate-600 mb-1">제출 기한</label><input type="date" id="teacher-homework-due-date" class="w-full p-2 border rounded-md"></div>
                </main>
                <footer class="p-6 border-t flex justify-end gap-3">
                    <button id="teacher-cancel-homework-btn" class="bg-slate-100 hover:bg-slate-200 text-slate-800 font-semibold py-2 px-5 rounded-lg">취소</button>
                    <button id="teacher-save-homework-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg">출제하기</button>
                </footer>
            </div>
        </div>
    </div>

    <div id="student-view" class="view">
        <div id="student-loading-screen" class="student-screen items-center justify-center"><div class="loader"></div></div>

        <div id="student-login-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-sm mx-auto">
                <div class="bg-white p-8 rounded-2xl shadow-lg text-center">
                    <h1 class="text-2xl font-bold text-slate-800 mb-6">학생 로그인</h1>
                    <div class="space-y-4 text-left">
                        <div><label for="student-class-select" class="block text-sm font-medium text-slate-700 mb-1">반</label><select id="student-class-select" class="w-full p-2 border border-slate-300 rounded-lg"></select></div>
                        <div><label for="student-name-select" class="block text-sm font-medium text-slate-700 mb-1">이름</label><select id="student-name-select" class="w-full p-2 border border-slate-300 rounded-lg" disabled></select></div>
                        <div><label for="student-password" class="block text-sm font-medium text-slate-700 mb-1">비밀번호</label><input type="password" id="student-password" class="w-full p-2 border border-slate-300 rounded-lg" placeholder="전화번호 뒷 4자리" disabled></div>
                    </div>
                    <button id="student-login-btn" class="mt-6 w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition disabled:opacity-50" disabled>로그인</button>
                    <button class="back-to-portal-btn mt-4 text-sm text-slate-500 hover:underline">포털로 돌아가기</button>
                </div>
            </div>
        </div>

        <div id="student-subject-selection-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-md mx-auto p-4">
                <header class="text-center mb-8"><h1 id="student-welcome-message" class="text-3xl font-bold text-slate-800"></h1><p class="text-slate-500 mt-2">학습할 과목을 선택하세요.</p></header>
                <main class="space-y-4">
                    <div id="student-subjects-list" class="space-y-3"></div>
                    <button id="student-goto-homework-btn" class="w-full p-4 text-lg font-semibold text-white bg-slate-700 rounded-lg hover:bg-slate-800 transition">숙제 제출</button>
                </main>
            </div>
        </div>

        <div id="student-lesson-selection-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-md mx-auto p-4">
                <button id="student-back-to-subjects-btn" class="mb-6 text-sm text-slate-500 hover:underline">&larr; 과목 선택으로 돌아가기</button>
                <header class="text-center mb-8"><h1 id="student-selected-subject-title" class="text-3xl font-bold text-slate-800"></h1><p class="text-slate-500 mt-2">진행할 학습을 선택하세요.</p></header>
                <main id="student-lessons-list" class="space-y-3"></main>
                <div id="student-no-lesson-screen" class="text-center py-10" style="display: none;">
                    <p class="text-slate-500">현재 진행 가능한 학습이 없습니다.</p>
                </div>
            </div>
        </div>
        
        <div id="student-homework-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-lg mx-auto p-4">
                 <button id="student-back-to-subjects-from-homework-btn" class="mb-6 text-sm text-slate-500 hover:underline">&larr; 과목 선택으로 돌아가기</button>
                <header class="text-center mb-8"><h1 class="text-3xl font-bold text-slate-800">숙제 목록</h1><p class="text-slate-500 mt-2">제출할 숙제를 선택하세요.</p></header>
                <main id="student-homework-list" class="space-y-3"></main>
            </div>
        </div>

        <div id="student-video1-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-4xl mx-auto p-4">
                <button id="student-back-to-lessons-from-video-btn" class="mb-4 text-sm text-slate-500 hover:underline">&larr; 학습 선택으로</button>
                <h1 id="student-video1-title" class="text-2xl font-bold text-slate-800 mb-4 text-center"></h1>
                <div class="aspect-w-16 aspect-h-9 mb-6"><iframe id="student-video1-iframe" class="w-full aspect-video rounded-lg shadow-lg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
                <button id="student-start-quiz-btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition">개념 확인 퀴즈 풀기</button>
            </div>
        </div>
        
        <div id="student-quiz-screen" class="student-screen items-center justify-center">
            <div class="w-full max-w-2xl mx-auto p-4">
                <div class="bg-white p-8 rounded-2xl shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <p id="student-progress-text" class="text-sm font-semibold text-slate-600"></p>
                        <p id="student-score-text" class="text-sm font-semibold text-slate-600"></p>
                    </div>
                    <div class="w-full bg-slate-200 rounded-full h-2.5 mb-6"><div id="student-progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div></div>
                    <h2 id="student-question-text" class="text-xl font-bold text-slate-800 mb-6 min-h-[60px]"></h2>
                    <div id="student-options-container" class="space-y-3"></div>
                </div>
            </div>
        </div>

        <div id="student-result-screen" class="student-screen items-center justify-center p-4">
            <div id="student-success-message" class="w-full max-w-4xl text-center" style="display: none;">
                <h1 class="text-4xl font-bold text-green-600">🎉 통과! 🎉</h1>
                <p id="student-result-score-text-success" class="mt-2 text-slate-600"></p>
                <div class="mt-8">
                    <h2 class="text-xl font-bold text-slate-800 mb-4">문제 풀이 영상</h2>
                    <div class="aspect-w-16 aspect-h-9 mb-6"><iframe id="student-review-video2-iframe" class="w-full aspect-video rounded-lg shadow-lg" frameborder="0" allowfullscreen></iframe></div>
                    <div class="flex gap-4 justify-center">
                        <button id="student-rewatch-video1-btn" class="bg-slate-200 text-slate-800 font-semibold py-2 px-5 rounded-lg hover:bg-slate-300">개념 영상 다시보기</button>
                        <button id="student-back-to-lessons-btn-success" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700">학습 목록으로</button>
                    </div>
                </div>
            </div>
            <div id="student-failure-message" class="w-full max-w-4xl text-center" style="display: none;">
                <h1 class="text-4xl font-bold text-red-600">💥 다시 도전! 💥</h1>
                <p id="student-result-score-text-failure" class="mt-2 text-slate-600"></p>
                 <div class="mt-8">
                    <h2 class="text-xl font-bold text-slate-800 mb-4">문제 풀이 영상</h2>
                    <div class="aspect-w-16 aspect-h-9 mb-6"><iframe id="student-video2-iframe" class="w-full aspect-video rounded-lg shadow-lg" frameborder="0" allowfullscreen></iframe></div>
                    <button id="student-retry-quiz-btn" class="bg-yellow-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-yellow-600">퀴즈 다시 풀기</button>
                </div>
            </div>
        </div>

        <div id="student-upload-modal" class="modal-backdrop" style="display: none;">
             <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <header class="p-6 border-b flex justify-between items-center">
                    <h2 id="student-upload-modal-title" class="text-xl font-bold text-slate-800"></h2>
                    <button id="student-close-upload-modal-btn" class="text-slate-500 hover:text-slate-800">&times;</button>
                </header>
                <main class="p-6 flex-grow overflow-y-auto custom-scrollbar">
                    <label for="student-homework-files-input" class="w-full border-2 border-dashed border-slate-300 rounded-lg flex flex-col justify-center items-center h-32 cursor-pointer hover:bg-slate-50">
                        <p class="text-slate-500">클릭하거나 파일을 여기로 드래그하세요</p>
                        <p class="text-sm text-slate-400">여러 장의 사진을 선택할 수 있습니다</p>
                    </label>
                    <input type="file" id="student-homework-files-input" class="hidden" multiple accept="image/*">
                    <div id="student-homework-preview-container" class="mt-4 grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4"></div>
                </main>
                <footer class="p-6 border-t flex justify-end gap-3">
                    <button id="student-cancel-upload-btn" class="bg-slate-100 hover:bg-slate-200 text-slate-800 font-semibold py-2 px-5 rounded-lg">취소</button>
                    <button id="student-upload-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg flex items-center justify-center min-w-[120px]">
                        <span id="student-upload-btn-text">업로드하기</span>
                        <div id="student-upload-loader" class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin hidden"></div>
                    </button>
                </footer>
            </div>
        </div>

    </div>
    
    <script type="module" src="/src/main.js"></script>
</body>
</html>